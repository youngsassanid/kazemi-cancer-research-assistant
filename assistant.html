<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assistant | Kazemi Cancer Research Assistant</title>
  <script src="https://cdn.plot.ly/plotly-2.33.0.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon">ðŸ”¬</div>
          <h1>Kazemi Cancer Research Assistant</h1>
        </div>
        <nav>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="features.html">Features</a></li>
            <li><a href="demo.html">Demo</a></li>
            <li><a href="assistant.html" class="active">Assistant</a></li>
            <li><a href="about.html">About</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <section class="app-container">
    <div class="container">
      <div class="section-title">
        <h2>AI Research Assistant</h2>
      </div>

      <!-- Prognosis Prediction -->
      <div class="app-section">
        <h3>Patient Prognosis Prediction</h3>
        <form id="prediction-form">
          <div class="form-group">
            <label for="age">Age</label>
            <input type="number" id="age" class="form-control" value="58" min="18" max="100" required />
          </div>
          <div class="form-group">
            <label for="tumor-size">Tumor Size (cm)</label>
            <input type="number" id="tumor-size" class="form-control" value="4.2" step="0.1" min="0" required />
          </div>
          <div class="form-group">
            <label for="tumor-grade">Tumor Grade (1â€“4)</label>
            <input type="number" id="tumor-grade" class="form-control" value="3" min="1" max="4" required />
          </div>
          <div class="form-group">
            <label for="lymph-nodes">Lymph Nodes Involved</label>
            <input type="number" id="lymph-nodes" class="form-control" value="2" min="0" required />
          </div>
          <div class="form-group">
            <label for="ki67">Ki67 Index (%)</label>
            <input type="number" id="ki67" class="form-control" value="65" min="0" max="100" required />
          </div>
          <div class="form-group">
            <label for="her2">HER2 Status</label>
            <select id="her2" class="form-control">
              <option value="0">Negative</option>
              <option value="1" selected>Positive</option>
            </select>
          </div>
          <div class="form-group">
            <label for="er">ER Status</label>
            <select id="er" class="form-control">
              <option value="0">Negative</option>
              <option value="1" selected>Positive</option>
            </select>
          </div>
          <div class="form-group">
            <label for="pr">PR Status</label>
            <select id="pr" class="form-control">
              <option value="0">Negative</option>
              <option value="1" selected>Positive</option>
            </select>
          </div>
          <div class="form-group">
            <label for="previous-treatments">Previous Treatments</label>
            <input type="number" id="previous-treatments" class="form-control" value="1" min="0" required />
          </div>
          <button type="submit" class="btn" id="predict-btn">
            Predict Prognosis <span class="loading" style="display:none;">Loading...</span>
          </button>
        </form>

        <div id="prediction-result" class="result-container" style="display:none;">
          <h4>Prediction Results</h4>
          <div class="result-item">
            <div class="result-title">Overall Prognosis</div>
            <div id="overall-prognosis" style="font-size:1.5rem; font-weight:700;"></div>
          </div>
          <div class="result-item">
            <div class="result-title">Risk Score</div>
            <div id="risk-score" style="font-weight:600;"></div>
          </div>
          <div class="result-item">
            <div class="result-title">Model Confidence</div>
            <div id="model-predictions"></div>
          </div>
        </div>
      </div>

      <!-- Other sections: Treatment, Drugs, Trials, Chart -->
      <div class="app-section">
        <h3>Treatment Recommendations</h3>
        <button id="recommend-btn" class="btn">Generate Recommendations</button>
        <div id="recommendations-result" class="result-container" style="display:none;">
          <h4>Recommended Protocols</h4>
          <div id="recommendations-list"></div>
        </div>
      </div>

      <div class="app-section">
        <h3>Drug Interaction Checker</h3>
        <div class="form-group">
          <label for="medications">Medications (comma-separated)</label>
          <input type="text" id="medications" class="form-control" value="Paclitaxel, Cisplatin, Warfarin" />
        </div>
        <button id="check-interactions-btn" class="btn">Check Interactions</button>
        <div id="interactions-result" class="result-container" style="display:none;">
          <h4>Interaction Analysis</h4>
          <div id="interactions-list"></div>
        </div>
      </div>

      <div class="app-section">
        <h3>Clinical Trial Finder</h3>
        <div class="form-group">
          <label for="cancer-type">Cancer Type</label>
          <input type="text" id="cancer-type" class="form-control" value="Breast Cancer" />
        </div>
        <div class="form-group">
          <label for="patient-age">Patient Age</label>
          <input type="number" id="patient-age" class="form-control" value="55" min="18" max="100" />
        </div>
        <div class="form-group">
          <label for="patient-stage">Stage</label>
          <input type="text" id="patient-stage" class="form-control" value="II" />
        </div>
        <button id="find-trials-btn" class="btn">Search Trials</button>
        <div id="trials-result" class="result-container" style="display:none;">
          <h4>Matching Trials</h4>
          <div id="trials-list"></div>
        </div>
      </div>

      <div class="app-section">
        <h3>Survival Analysis Visualization</h3>
        <button id="generate-chart-btn" class="btn">Generate Kaplan-Meier Curve</button>
        <div id="chart-container" class="chart-container"></div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">ðŸ”¬</div>
        <h3>Kazemi Cancer Research Assistant</h3>
        <p>Advancing Oncology Through Artificial Intelligence</p>
      </div>
    </div>
  </footer>

  <script src="data.js"></script>
  <script>
    function setLoading(btnId, loading) {
      const btn = document.getElementById(btnId);
      const span = btn.querySelector('.loading');
      if (loading) {
        btn.disabled = true;
        span.style.display = 'inline-block';
      } else {
        btn.disabled = false;
        span.style.display = 'none';
      }
    }

    document.getElementById('prediction-form').addEventListener('submit', function(e) {
      e.preventDefault();
      setLoading('predict-btn', true);

      setTimeout(() => {
        const risk = (Math.random() * 40 + 50).toFixed(2);
        const prognosis = risk > 75 ? 'Poor' : risk > 60 ? 'Guarded' : 'Favorable';
        const color = risk > 75 ? 'var(--danger)' : risk > 60 ? 'var(--warning)' : 'var(--success)';

        document.getElementById('overall-prognosis').textContent = prognosis;
        document.getElementById('overall-prognosis').style.color = color;
        document.getElementById('risk-score').textContent = `${risk}% (High Risk)`;
        document.getElementById('model-predictions').innerHTML = `
          <small>RF: ${(risk*0.98).toFixed(1)}% | XGB: ${(risk*1.02).toFixed(1)}% | NN: ${risk}%</small>
        `;
        document.getElementById('prediction-result').style.display = 'block';
        setLoading('predict-btn', false);
      }, 1200);
    });

    document.getElementById('recommend-btn').addEventListener('click', () => {
      document.getElementById('recommendations-list').innerHTML = `
        <ul style="margin-left:20px;">
          <li>Trastuzumab + Pertuzumab (HER2-targeted)</li>
          <li>Paclitaxel weekly regimen</li>
          <li>Consider T-DM1 if progression</li>
        </ul>
      `;
      document.getElementById('recommendations-result').style.display = 'block';
    });

    document.getElementById('check-interactions-btn').addEventListener('click', () => {
      document.getElementById('interactions-list').innerHTML = `
        <p style="color:var(--danger);"><strong>Major Interaction:</strong> Warfarin + Cisplatin to increased bleeding risk</p>
        <p style="margin-top:0.5rem;"><small>Alternative: Consider DOAC if renal function allows</small></p>
      `;
      document.getElementById('interactions-result').style.display = 'block';
    });

    document.getElementById('find-trials-btn').addEventListener('click', () => {
      document.getElementById('trials-list').innerHTML = `
        <ul style="margin-left:20px;">
          <li><strong>NCT04553133</strong> â€“ T-DXd vs T-DM1 in HER2+ BC (Phase III)</li>
          <li><strong>NCT05206331</strong> â€“ Sacituzumab Govitecan in TNBC</li>
        </ul>
      `;
      document.getElementById('trials-result').style.display = 'block';
    });

    document.getElementById('generate-chart-btn').addEventListener('click', () => {
      const trace1 = { x: [0, 12, 24, 36, 48, 60], y: [1.0, 0.85, 0.68, 0.55, 0.42, 0.35], mode: 'lines+markers', name: 'Treatment Arm', line: { color: 'rgb(37, 99, 235)', width: 3 } };
      const trace2 = { x: [0, 12, 24, 36, 48, 60], y: [1.0, 0.78, 0.58, 0.42, 0.30, 0.22], mode: 'lines+markers', name: 'Control Arm', line: { color: 'rgb(239, 68, 68)', width: 3, dash: 'dot' } };
      const layout = {
        title: { text: 'Kaplan-Meier Survival Curve', font: { size: 18 } },
        xaxis: { title: 'Months' },
        yaxis: { title: 'Survival Probability', range: [0, 1] },
        hovermode: 'x unified',
        legend: { x: 0.7, y: 0.9 },
        margin: { t: 60, b: 60, l: 60, r: 60 }
      };
      Plotly.newPlot('chart-container', [trace1, trace2], layout, { responsive: true });
    });
  </script>
</body>
</html>